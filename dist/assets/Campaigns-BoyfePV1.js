import{c as x,E as v,l as e,r as k,Q as D,J as j,o as fe,a as xe,k as A,H as M,p as N,z as w,b as O,f as X,q as o,R as S,W as H,M as V,S as J,e as ee,F as be,y as ye,x as G,X as Z}from"./vendor-Cn5j0SEu.js";import{b as ke,u as we,d as te}from"./index-DyprfSbd.js";import{r as Se}from"./PlusIcon-Hols0ICP.js";import{r as se}from"./CheckCircleIcon-9dtlsCvY.js";import{r as Ae}from"./ClockIcon-A7fuk63B.js";import"./excel-C9Ruqv6W.js";function ae(U,i){return v(),x("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})])}function _e(U,i){return v(),x("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})])}function Me(U,i){return v(),x("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}class Ee{constructor(){this.isActive=!1,this.queue=[],this.stats={sent:0,failed:0,total:0}}async sendMessage(i,n,d={}){if(console.log(`ğŸš€ Sending WhatsApp to ${i}`),!i||!n)return this.stats.failed++,{success:!1,method:"validation-error",error:"Phone number and message are required",timestamp:new Date().toISOString()};const p=this.cleanPhoneNumber(i),_=encodeURIComponent(n),g=`https://wa.me/${p}?text=${_}`;try{if(d.openInNewTab!==!1){const h=window.open(g,"_blank","noopener,noreferrer,width=800,height=600");if(h)return console.log("âœ… WhatsApp opened in new tab"),this.stats.sent++,setTimeout(()=>{try{h.focus()}catch{}},100),{success:!0,method:"window-open",url:g,phone:p,timestamp:new Date().toISOString()}}const r=document.createElement("a");r.href=g,r.target="_blank",r.rel="noopener noreferrer",r.style.display="none",r.style.position="absolute",r.style.left="-9999px",document.body.appendChild(r);const c=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});return r.dispatchEvent(c),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},1e3),console.log("âœ… WhatsApp link clicked"),this.stats.sent++,{success:!0,method:"link-click",url:g,phone:p,timestamp:new Date().toISOString()}}catch(r){return console.error("âŒ Error sending WhatsApp:",r),this.stats.failed++,{success:!1,method:"error",error:r.message,phone:p,timestamp:new Date().toISOString()}}}cleanPhoneNumber(i){let n=i.replace(/\D/g,"");return n.startsWith("0")?n="62"+n.substring(1):n.startsWith("62")||(n="62"+n),n}async sendBulkMessages(i,n,d=3){if(!i||i.length===0)return console.warn("No recipients provided for bulk messaging"),{success:!1,error:"No recipients provided",total:0,sent:0,failed:0,results:[]};this.isActive=!0,this.stats.total=i.length,this.stats.sent=0,this.stats.failed=0;const p=[];console.log(`ğŸš€ Starting bulk WhatsApp campaign to ${i.length} recipients`);for(let g=0;g<i.length&&this.isActive;g++){const r=i[g];try{console.log(`ğŸ“¤ Processing ${g+1}/${i.length}: ${r.name} (${r.phone})`);const c=this.personalizeMessage(n,r),h=await this.sendMessage(r.phone,c,{openInNewTab:g===0}),E={name:r.name,phone:r.phone,success:h.success,method:h.method,timestamp:h.timestamp,error:h.error||null};p.push(E);const b=h.success?"âœ…":"âŒ";console.log(`${b} ${g+1}/${i.length} - ${r.name}: ${h.success?"Success":h.error}`),window.dispatchEvent(new CustomEvent("whatsapp:progress",{detail:{current:g+1,total:i.length,sent:this.stats.sent,failed:this.stats.failed,currentRecipient:r,lastResult:h}})),g<i.length-1&&this.isActive&&(console.log(`â±ï¸ Waiting ${d} seconds before next message...`),await this.delay(d*1e3))}catch(c){console.error(`âŒ Error sending to ${r.name}:`,c),this.stats.failed++;const h={name:r.name,phone:r.phone,success:!1,error:c.message,timestamp:new Date().toISOString()};p.push(h),window.dispatchEvent(new CustomEvent("whatsapp:progress",{detail:{current:g+1,total:i.length,sent:this.stats.sent,failed:this.stats.failed,currentRecipient:r,lastResult:{success:!1,error:c.message}}}))}}this.isActive=!1;const _={total:i.length,sent:this.stats.sent,failed:this.stats.failed,successRate:i.length>0?Math.round(this.stats.sent/i.length*100):0};return console.log("ğŸ‰ Bulk campaign completed:",_),window.dispatchEvent(new CustomEvent("whatsapp:complete",{detail:{..._,results:p,completedAt:new Date().toISOString()}})),{success:!0,..._,results:p}}personalizeMessage(i,n){return i.replace(/\[\[NAME\]\]/g,n.name||"").replace(/\[\[NICKNAME\]\]/g,n.nickname||"").replace(/\[\[PHONE\]\]/g,n.phone||"").replace(/\{nama\}/g,n.name||"").replace(/\{panggilan\}/g,n.nickname||"").replace(/\{hp\}/g,n.phone||"")}delay(i){return new Promise(n=>setTimeout(n,i))}getStats(){return{...this.stats,isActive:this.isActive}}resetStats(){this.stats={sent:0,failed:0,total:0}}stop(){this.isActive=!1,console.log("ğŸ›‘ WhatsApp sender stopped")}async testConnection(i="6281234567890"){const n=`ğŸ§ª Test message from StarSender - ${new Date().toLocaleTimeString()}`;try{const d=await this.sendMessage(i,n,{openInNewTab:!0});return d.success?(console.log("âœ… WhatsApp test connection successful"),{success:!0,message:"WhatsApp connection test successful",method:d.method,timestamp:d.timestamp}):(console.error("âŒ WhatsApp test connection failed:",d.error),{success:!1,message:"WhatsApp connection test failed",error:d.error,timestamp:d.timestamp})}catch(d){return console.error("âŒ WhatsApp test connection error:",d),{success:!1,message:"WhatsApp connection test error",error:d.message,timestamp:new Date().toISOString()}}}getSystemInfo(){return{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,timestamp:new Date().toISOString()}}}const z=new Ee;window.whatsappSender=z;console.log("ğŸš€ WhatsApp Sender initialized - CORS Bypass ready!");const Te={class:"space-y-6"},Be={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ce={class:"card p-6"},Pe={class:"flex items-center justify-between mb-4"},Re={class:"space-y-2"},Ie={class:"flex items-center justify-between text-sm"},We={class:"flex items-center justify-between text-sm"},Ue={class:"text-gray-900"},$e={class:"flex items-center justify-between text-sm"},Le={class:"text-green-600"},De={class:"mt-4 pt-4 border-t border-gray-200"},Oe=["disabled"],He={class:"card p-6"},Ke={class:"space-y-4"},je={value:"all"},Ve={value:"unpaid"},Je={value:"paid"},Ge=["disabled"],Ze={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},ze={class:"card p-6"},Qe={class:"flex items-center"},qe={class:"p-2 bg-blue-100 rounded-lg"},Ye={class:"ml-4"},Fe={class:"text-2xl font-semibold text-gray-900"},Xe={class:"card p-6"},et={class:"flex items-center"},tt={class:"p-2 bg-green-100 rounded-lg"},st={class:"ml-4"},at={class:"text-2xl font-semibold text-gray-900"},nt={class:"card p-6"},lt={class:"flex items-center"},ot={class:"p-2 bg-yellow-100 rounded-lg"},it={class:"ml-4"},rt={class:"text-2xl font-semibold text-gray-900"},dt={class:"card p-6"},ut={class:"flex items-center"},ct={class:"p-2 bg-purple-100 rounded-lg"},mt={class:"ml-4"},pt={class:"text-2xl font-semibold text-gray-900"},gt={key:0,class:"card p-6"},ht={class:"flex items-center justify-between mb-4"},vt={class:"space-y-4"},ft={class:"flex justify-between text-sm text-gray-600 mb-2"},xt={class:"w-full bg-gray-200 rounded-full h-2"},bt={class:"grid grid-cols-3 gap-4 text-center"},yt={class:"text-2xl font-bold text-green-600"},kt={class:"text-2xl font-bold text-red-600"},wt={class:"text-2xl font-bold text-blue-600"},St={key:0,class:"text-sm text-gray-600 text-center"},At={class:"card"},_t={class:"overflow-x-auto"},Mt={class:"min-w-full divide-y divide-gray-200"},Et={class:"bg-white divide-y divide-gray-200"},Tt={class:"px-6 py-4 whitespace-nowrap"},Bt={class:"text-sm font-medium text-gray-900"},Nt={class:"text-sm text-gray-500 truncate max-w-xs"},Ct={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-sm text-gray-900"},Rt={class:"text-sm text-gray-500"},It={class:"px-6 py-4 whitespace-nowrap"},Wt={class:"px-6 py-4 whitespace-nowrap"},Ut={class:"flex items-center"},$t={class:"w-full bg-gray-200 rounded-full h-2 mr-2"},Lt={class:"text-xs text-gray-500"},Dt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ot={class:"flex space-x-2"},Ht=["onClick"],Kt=["onClick"],jt=["onClick"],Vt={key:0,class:"text-center py-12"},Jt={class:"p-6"},Gt={class:"flex items-center justify-between mb-6"},Zt={class:"space-y-2"},zt={class:"flex items-center"},Qt={class:"flex items-center"},qt={class:"flex items-center"},Yt={class:"flex flex-col sm:flex-row sm:justify-end space-y-3 sm:space-y-0 sm:space-x-3 pt-6 border-t border-gray-200"},Ft=["disabled"],Xt={class:"p-6"},es={class:"flex items-center justify-between mb-6"},ts={class:"text-xl font-medium text-gray-900"},ss={key:0,class:"space-y-4"},as={class:"grid grid-cols-2 gap-4"},ns={class:"text-sm text-gray-900"},ls={class:"mt-1 p-3 bg-gray-50 rounded-lg"},os={class:"whitespace-pre-wrap text-sm text-gray-900"},is={key:0,class:"border rounded-lg p-4"},rs={class:"grid grid-cols-3 gap-4 text-center"},ds={class:"text-2xl font-bold text-green-600"},us={class:"text-2xl font-bold text-red-600"},cs={class:"text-2xl font-bold text-blue-600"},xs={__name:"Campaigns",setup(U){const i=ke(),n=we(),d=k([]),p=k([]),_=k(!1),g=k(!1),r=k(!1),c=k(!1),h=k(!1),E=k(!1),b=k(null),R=k(!0),T=D({totalSent:0,successRate:100}),l=D({active:!1,current:0,total:0,sent:0,failed:0,remaining:0,currentRecipient:null}),f=D({target:"unpaid",template:"",message:""}),u=D({title:"",message:"",target:"unpaid",template:"",delay:10}),I=j(()=>p.value),W=j(()=>[]),ne=j(()=>d.value.filter(s=>{if(!s.executedAt)return!1;const t=new Date().toDateString(),m=new Date(s.executedAt).toDateString();return t===m}).length),$={reminder:`Halo [[NAME]]! ğŸ‘‹

ğŸ’° **Reminder Pembayaran Kas Kelas**

Ini adalah pengingat pembayaran kas kelas untuk bulan ini.

Silakan segera lakukan pembayaran agar administrasi kelas tetap lancar.

Terima kasih! ğŸ™`,multi_month_offer:`ğŸ¯ *PENAWARAN SPESIAL PEMBAYARAN MULTI-BULAN* ğŸ¯

Assalamu'alaikum Wr. Wb.

Halo Bapak/Ibu orang tua dari *[[NAME]]* ğŸ‘‹

Kami menawarkan kemudahan pembayaran kas kelas dengan sistem *MULTI-BULAN* yang lebih praktis!

ğŸ“¦ *PAKET PEMBAYARAN TERSEDIA:*

1. ğŸ“… *PAKET TRIWULAN (3 Bulan)*
   ğŸ’° Rp 150.000 (3 Ã— Rp 50.000)
   âœ… Lebih terjangkau
   âœ… Fleksibel

2. ğŸ¯ *PAKET SEMESTER (6 Bulan)* - POPULER!
   ğŸ’° Rp 300.000 (6 Ã— Rp 50.000)
   âœ… Paling praktis
   âœ… Hemat waktu

3. â­ *PAKET 3 CAWU (9 Bulan)*
   ğŸ’° Rp 450.000 (9 Ã— Rp 50.000)
   âœ… Hampir setahun
   âœ… Sangat praktis

ğŸ’¡ *KEUNTUNGAN MULTI-BULAN:*
âœ… Tidak perlu ingat bayar setiap bulan
âœ… Bisa pilih bayar sekaligus atau bertahap
âœ… Link pembayaran otomatis tersedia
âœ… Tracking progress yang jelas

ğŸ”— Untuk membuat link pembayaran, silakan hubungi bendahara kelas atau akses sistem kas kelas.

Terima kasih! ğŸ™

Wassalamu'alaikum Wr. Wb.`,payment_options:`ğŸ’³ *OPSI PEMBAYARAN FLEKSIBEL* ğŸ’³

Assalamu'alaikum Wr. Wb.

Halo *[[NAME]]* ğŸ‘‹

Untuk kemudahan pembayaran kas kelas, kami menyediakan berbagai opsi:

ğŸ¯ *PILIHAN PEMBAYARAN:*

1. ğŸ“… *BULANAN REGULER*
   ğŸ’° Rp 50.000/bulan
   âœ… Bayar setiap bulan
   âœ… Paling fleksibel

2. ğŸ’° *MULTI-BULAN SEKALIGUS*
   ğŸ’° Pilih: 3, 6, atau 9 bulan
   âœ… Lebih praktis
   âœ… Tidak perlu repot setiap bulan

3. ğŸ”„ *KOMBINASI*
   âœ… Bayar bertahap per bulan
   âœ… Atau sekaligus (terserah pilihan)

ğŸ’³ *METODE PEMBAYARAN:*
âœ… QRIS (Scan QR Code)
âœ… GoPay, OVO, DANA, ShopeePay
âœ… Transfer Bank
âœ… Kartu Kredit/Debit

ğŸ”— Link pembayaran akan dikirimkan sesuai pilihan Bapak/Ibu.

Silakan hubungi bendahara untuk memilih opsi yang paling sesuai!

Terima kasih! ğŸ™

Wassalamu'alaikum Wr. Wb.`,urgent:`ğŸš¨ **URGENT** - [[NAME]]

Pembayaran kas kelas sudah memasuki batas waktu. Mohon segera melakukan pembayaran hari ini.

Hubungi bendahara jika ada kendala.

Terima kasih atas perhatiannya! ğŸ™`,announcement:`ğŸ“¢ **Pengumuman Penting**

Halo [[NAME]]!

Ada pengumuman penting untuk kelas kita. Silakan check group WA atau hubungi ketua kelas untuk informasi lebih lanjut.

Terima kasih! ğŸ™`,payment_reminder:`Halo [[NAME]]! ğŸ‘‹

ğŸ’° Reminder pembayaran kas kelas bulan ini:

â€¢ Jumlah: Rp 50.000
â€¢ Jatuh tempo: Akhir bulan
â€¢ Status: Belum bayar

Silakan segera lakukan pembayaran. Terima kasih! ğŸ™`,payment_urgent:`ğŸš¨ URGENT - [[NAME]]

Pembayaran kas kelas sudah terlambat! Mohon segera bayar hari ini untuk menghindari denda.

Hubungi bendahara jika ada kendala: 08xxx

Terima kasih! ğŸ™`,announcement:`ğŸ“¢ **Pengumuman Kelas**

Halo [[NAME]]!

Ada informasi penting untuk kelas. Silakan baca dengan seksama dan konfirmasi jika diperlukan.

Detail akan disampaikan di group kelas.

Terima kasih! ğŸ™`,event:`ğŸ‰ **Info Kegiatan Kelas**

Halo [[NAME]]!

Ada kegiatan kelas yang akan datang. Mohon persiapkan diri dan catat tanggalnya ya!

Info lengkap di group WA kelas.

Sampai jumpa! ğŸ‘‹`,thanks:`ğŸ™ **Terima Kasih**

Halo [[NAME]]!

Terima kasih atas partisipasi aktif dalam kegiatan kelas. Dukungan kalian sangat berarti!

Keep up the good work! ğŸ’ª`},le=async()=>{try{_.value=!0,await i.fetchStudents(),p.value=i.students||[];const s=localStorage.getItem("campaigns");s&&(d.value=JSON.parse(s));const t=localStorage.getItem("broadcastStats");if(t){const m=JSON.parse(t);Object.assign(T,m)}}catch(s){console.error("Error loading data:",s),n.error("Gagal memuat data")}finally{_.value=!1}},oe=async()=>{r.value=!0;try{const s="ğŸ§ª Test broadcast dari Campaign System - "+new Date().toLocaleTimeString();if(p.value.length>0){const t=p.value[0],m=await z.sendMessage(t.phone,s);m.success?n.success("Test broadcast berhasil! WhatsApp terbuka."):n.error("Test broadcast gagal: "+m.error)}else n.warning("Tidak ada data siswa untuk test")}catch(s){console.error("Test broadcast error:",s),n.error("Error saat test broadcast")}finally{r.value=!1}},ie=()=>{f.template&&$[f.template]&&(f.message=$[f.template])},re=async()=>{if(!f.message.trim()){n.error("Pesan tidak boleh kosong");return}c.value=!0;try{let s=[];switch(f.target){case"all":s=p.value;break;case"unpaid":s=I.value;break;case"paid":s=W.value;break}if(s.length===0){n.warning("Tidak ada penerima yang dipilih");return}await Q(s,f.message,5),f.message="",f.template=""}catch(s){console.error("Quick broadcast error:",s),n.error("Gagal mengirim quick broadcast")}finally{c.value=!1}},Q=async(s,t,m=10)=>{l.active=!0,l.current=0,l.total=s.length,l.sent=0,l.failed=0,l.remaining=s.length;const a=[];try{for(let B=0;B<s.length&&c.value;B++){const y=s[B];l.currentRecipient=y;try{const P=t.replace(/\[\[NAME\]\]/g,y.name||"").replace(/\[\[NICKNAME\]\]/g,y.nickname||"").replace(/\[\[PHONE\]\]/g,y.phone||""),K=await z.sendMessage(y.phone,P,{openInNewTab:B===0});K.success?(l.sent++,n.success(`âœ… Terkirim ke ${y.name}`,{timeout:2e3})):(l.failed++,n.error(`âŒ Gagal ke ${y.name}`,{timeout:2e3})),a.push({name:y.name,phone:y.phone,success:K.success,timestamp:K.timestamp})}catch(P){console.error(`Error sending to ${y.name}:`,P),l.failed++,a.push({name:y.name,phone:y.phone,success:!1,error:P.message})}l.current=B+1,l.remaining=s.length-(B+1),B<s.length-1&&c.value&&await new Promise(P=>setTimeout(P,m*1e3))}T.totalSent+=l.sent,localStorage.setItem("broadcastStats",JSON.stringify(T));const C=Math.round(l.sent/s.length*100);n.success(`ğŸ‰ Broadcast selesai! ${l.sent}/${s.length} berhasil (${C}%)`)}finally{l.active=!1,l.currentRecipient=null}return a},de=()=>{c.value=!1,n.info("ğŸ›‘ Broadcast dihentikan")},ue=()=>{u.template&&$[u.template]&&(u.message=$[u.template])},ce=async()=>{if(!u.title.trim()||!u.message.trim()){n.error("Judul dan pesan harus diisi");return}g.value=!0;try{let s=[];switch(u.target){case"all":s=p.value;break;case"unpaid":s=I.value;break;case"paid":s=W.value;break}const t={id:"campaign_"+Date.now(),title:u.title,message:u.message,target:u.target,totalRecipients:s.length,delay:parseInt(u.delay),status:"draft",createdAt:new Date().toISOString(),results:null};d.value.push(t),localStorage.setItem("campaigns",JSON.stringify(d.value)),n.success("Campaign berhasil dibuat"),L()}catch(s){console.error("Error saving campaign:",s),n.error("Gagal menyimpan campaign")}finally{g.value=!1}},me=async s=>{if(confirm(`Yakin ingin menjalankan campaign "${s.title}"?`)){c.value=!0;try{let t=[];switch(s.target){case"all":t=p.value;break;case"unpaid":t=I.value;break;case"paid":t=W.value;break}if(t.length===0){n.warning("Tidak ada penerima untuk campaign ini");return}s.status="running",s.executedAt=new Date().toISOString();const m=await Q(t,s.message,s.delay);s.status="completed",s.results={total:t.length,sent:l.sent,failed:l.failed,details:m},localStorage.setItem("campaigns",JSON.stringify(d.value))}catch(t){console.error("Error executing campaign:",t),s.status="failed",n.error("Gagal menjalankan campaign")}finally{c.value=!1}}},pe=s=>{b.value=s,E.value=!0},ge=s=>{if(!confirm("Yakin ingin menghapus campaign ini?"))return;const t=d.value.findIndex(m=>m.id===s);t!==-1&&(d.value.splice(t,1),localStorage.setItem("campaigns",JSON.stringify(d.value)),n.success("Campaign berhasil dihapus"))},L=()=>{h.value=!1,Object.assign(u,{title:"",message:"",target:"unpaid",template:"",delay:10})},he=s=>({all:"Semua Siswa",paid:"Sudah Bayar",unpaid:"Belum Bayar"})[s]||s,q=s=>({draft:"Draft",running:"Berjalan",completed:"Selesai",failed:"Gagal"})[s]||s,Y=s=>({draft:"bg-gray-100 text-gray-800",running:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",F=s=>s.results?Math.round(s.results.sent/s.results.total*100):s.status==="completed"?100:0,ve=()=>{window.addEventListener("whatsapp:progress",s=>{const{current:t,total:m,sent:a,failed:C}=s.detail;l.current=t,l.total=m,l.sent=a,l.failed=C,l.remaining=m-t}),window.addEventListener("whatsapp:complete",s=>{const{total:t,sent:m,failed:a}=s.detail;l.active=!1,T.totalSent+=m,localStorage.setItem("broadcastStats",JSON.stringify(T))})};return fe(()=>{le(),ve()}),xe(()=>{c.value=!1}),(s,t)=>{var m;return v(),x("div",Te,[e("div",Be,[t[16]||(t[16]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Campaign WhatsApp"),e("p",{class:"mt-1 text-sm text-gray-500"}," Broadcast pesan otomatis ke multiple nomor WhatsApp ")],-1)),e("button",{onClick:t[0]||(t[0]=a=>h.value=!0),class:"btn-primary mt-4 sm:mt-0"},[M(w(Se),{class:"w-5 h-5 mr-2"}),t[15]||(t[15]=N(" Buat Campaign Baru ",-1))])]),e("div",Ne,[e("div",Ce,[e("div",Pe,[t[17]||(t[17]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900 flex items-center"}," ğŸŒŸ StarSender Status "),e("p",{class:"text-sm text-gray-600"},"Sistem broadcast WhatsApp")],-1)),e("div",{class:O(R.value?"text-green-600":"text-red-600")},[R.value?(v(),X(w(se),{key:0,class:"w-6 h-6"})):(v(),X(w(Me),{key:1,class:"w-6 h-6"}))],2)]),e("div",Re,[e("div",Ie,[t[18]||(t[18]=e("span",{class:"text-gray-600"},"Status:",-1)),e("span",{class:O(R.value?"text-green-600":"text-red-600")},o(R.value?"Ready":"Not Configured"),3)]),e("div",We,[t[19]||(t[19]=e("span",{class:"text-gray-600"},"Total Sent:",-1)),e("span",Ue,o(T.totalSent),1)]),e("div",$e,[t[20]||(t[20]=e("span",{class:"text-gray-600"},"Success Rate:",-1)),e("span",Le,o(T.successRate)+"%",1)])]),e("div",De,[e("button",{onClick:oe,disabled:!R.value||r.value,class:"btn-sm btn-secondary w-full"},o(r.value?"Testing...":"ğŸ§ª Test Broadcast"),9,Oe)])]),e("div",He,[t[24]||(t[24]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"âš¡ Quick Broadcast",-1)),e("div",Ke,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Target",-1)),S(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>f.target=a),class:"input-field"},[e("option",je,"Semua Siswa ("+o(p.value.length)+")",1),e("option",Ve,"Belum Bayar ("+o(I.value.length)+")",1),e("option",Je,"Sudah Bayar ("+o(W.value.length)+")",1)],512),[[H,f.target]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pesan Cepat",-1)),S(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>f.template=a),onChange:ie,class:"input-field"},t[22]||(t[22]=[V('<option value="">-- Pilih Template --</option><option value="reminder">ğŸ’° Reminder Pembayaran</option><option value="multi_month_offer">ğŸ¯ Penawaran Multi-Bulan (3,6,9)</option><option value="payment_options">ğŸ’³ Opsi Pembayaran Fleksibel</option><option value="urgent">ğŸš¨ Urgent - Pembayaran Segera</option><option value="announcement">ğŸ“¢ Pengumuman Penting</option><option value="custom">âœï¸ Custom Message</option>',7)]),544),[[H,f.template]])]),e("div",null,[S(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>f.message=a),rows:"3",class:"input-field",placeholder:"Ketik pesan atau pilih template..."},null,512),[[J,f.message]])]),e("button",{onClick:re,disabled:!f.message||c.value,class:"btn-primary w-full"},o(c.value?"Mengirim...":"ğŸš€ Kirim Sekarang"),9,Ge)])])]),e("div",Ze,[e("div",ze,[e("div",Qe,[e("div",qe,[M(w(ae),{class:"w-6 h-6 text-blue-600"})]),e("div",Ye,[t[25]||(t[25]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Campaign",-1)),e("p",Fe,o(d.value.length),1)])])]),e("div",Xe,[e("div",et,[e("div",tt,[M(w(se),{class:"w-6 h-6 text-green-600"})]),e("div",st,[t[26]||(t[26]=e("p",{class:"text-sm font-medium text-gray-600"},"Selesai",-1)),e("p",at,o(d.value.filter(a=>a.status==="completed").length),1)])])]),e("div",nt,[e("div",lt,[e("div",ot,[M(w(Ae),{class:"w-6 h-6 text-yellow-600"})]),e("div",it,[t[27]||(t[27]=e("p",{class:"text-sm font-medium text-gray-600"},"Terjadwal",-1)),e("p",rt,o(d.value.filter(a=>a.status==="scheduled").length),1)])])]),e("div",dt,[e("div",ut,[e("div",ct,[M(w(_e),{class:"w-6 h-6 text-purple-600"})]),e("div",mt,[t[28]||(t[28]=e("p",{class:"text-sm font-medium text-gray-600"},"Broadcast Hari Ini",-1)),e("p",pt,o(ne.value),1)])])])]),c.value||l.active?(v(),x("div",gt,[e("div",ht,[t[29]||(t[29]=e("h3",{class:"text-lg font-semibold text-gray-900"},"ğŸ“¤ Broadcasting Progress",-1)),c.value?(v(),x("button",{key:0,onClick:de,class:"btn-sm btn-secondary"}," ğŸ›‘ Stop ")):A("",!0)]),e("div",vt,[e("div",null,[e("div",ft,[e("span",null,"Progress: "+o(l.current)+"/"+o(l.total),1),e("span",null,o(Math.round(l.current/l.total*100))+"%",1)]),e("div",xt,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:ee({width:l.current/l.total*100+"%"})},null,4)])]),e("div",bt,[e("div",null,[e("div",yt,o(l.sent),1),t[30]||(t[30]=e("div",{class:"text-sm text-gray-500"},"Berhasil",-1))]),e("div",null,[e("div",kt,o(l.failed),1),t[31]||(t[31]=e("div",{class:"text-sm text-gray-500"},"Gagal",-1))]),e("div",null,[e("div",wt,o(l.remaining),1),t[32]||(t[32]=e("div",{class:"text-sm text-gray-500"},"Sisa",-1))])]),l.currentRecipient?(v(),x("div",St,[t[33]||(t[33]=N(" Mengirim ke: ",-1)),e("strong",null,o(l.currentRecipient.name),1),N(" ("+o(l.currentRecipient.phone)+") ",1)])):A("",!0)])])):A("",!0),e("div",At,[t[37]||(t[37]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Daftar Campaign")],-1)),e("div",_t,[e("table",Mt,[t[34]||(t[34]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Campaign "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Target "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Progress "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Aksi ")])],-1)),e("tbody",Et,[(v(!0),x(be,null,ye(d.value,a=>(v(),x("tr",{key:a.id},[e("td",Tt,[e("div",null,[e("div",Bt,o(a.title),1),e("div",Nt,o(a.message.substring(0,50))+"...",1)])]),e("td",Ct,[e("div",Pt,o(he(a.target)),1),e("div",Rt,o(a.totalRecipients||0)+" nomor",1)]),e("td",It,[e("span",{class:O([Y(a.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},o(q(a.status)),3)]),e("td",Wt,[e("div",Ut,[e("div",$t,[e("div",{class:"bg-blue-600 h-2 rounded-full",style:ee({width:F(a)+"%"})},null,4)]),e("span",Lt,o(F(a))+"%",1)])]),e("td",Dt,[e("div",Ot,[e("button",{onClick:C=>pe(a),class:"text-blue-600 hover:text-blue-900"}," Lihat ",8,Ht),a.status==="draft"?(v(),x("button",{key:0,onClick:C=>me(a),class:"text-green-600 hover:text-green-900"}," Jalankan ",8,Kt)):A("",!0),e("button",{onClick:C=>ge(a.id),class:"text-red-600 hover:text-red-900"}," Hapus ",8,jt)])])]))),128))])]),d.value.length===0?(v(),x("div",Vt,[M(w(ae),{class:"mx-auto h-12 w-12 text-gray-400"}),t[35]||(t[35]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Belum ada campaign",-1)),t[36]||(t[36]=e("p",{class:"mt-1 text-sm text-gray-500"},"Mulai dengan membuat campaign pertama atau gunakan Quick Broadcast.",-1))])):A("",!0)])]),h.value?(v(),x("div",{key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:L},[e("div",{class:"relative w-full max-w-2xl bg-white rounded-lg shadow-xl max-h-full overflow-y-auto",onClick:t[11]||(t[11]=G(()=>{},["stop"]))},[e("div",Jt,[e("div",Gt,[t[38]||(t[38]=e("h3",{class:"text-xl font-medium text-gray-900"},"Buat Campaign Baru",-1)),e("button",{onClick:L,class:"text-gray-400 hover:text-gray-600"},[M(w(te),{class:"w-6 h-6"})])]),e("form",{onSubmit:G(ce,["prevent"]),class:"space-y-6"},[e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Judul Campaign ",-1)),S(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>u.title=a),type:"text",required:"",class:"input-field",placeholder:"Contoh: Reminder Pembayaran Kas Januari"},null,512),[[J,u.title]])]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Template Pesan ",-1)),S(e("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>u.template=a),onChange:ue,class:"input-field mb-3"},t[40]||(t[40]=[V('<option value="">-- Pilih Template --</option><option value="payment_reminder">ğŸ’° Reminder Pembayaran Kas</option><option value="payment_urgent">ğŸš¨ Urgent - Pembayaran Terlambat</option><option value="announcement">ğŸ“¢ Pengumuman Kelas</option><option value="event">ğŸ‰ Informasi Kegiatan</option><option value="thanks">ğŸ™ Terima Kasih</option><option value="custom">âœï¸ Custom Message</option>',7)]),544),[[H,u.template]]),S(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=a=>u.message=a),rows:"8",required:"",class:"input-field",placeholder:"Ketik pesan Anda di sini..."},null,512),[[J,u.message]]),t[42]||(t[42]=e("div",{class:"mt-2 text-sm text-gray-500"},[e("p",null,[e("strong",null,"Variable tersedia:"),N(" [[NAME]], [[NICKNAME]], [[PHONE]]")])],-1))]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Target Penerima ",-1)),e("div",Zt,[e("label",zt,[S(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>u.target=a),type:"radio",value:"all",class:"mr-2"},null,512),[[Z,u.target]]),N(" Semua Siswa ("+o(p.value.length)+" siswa) ",1)]),e("label",Qt,[S(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>u.target=a),type:"radio",value:"unpaid",class:"mr-2"},null,512),[[Z,u.target]]),N(" Siswa Belum Bayar ("+o(I.value.length)+" siswa) ",1)]),e("label",qt,[S(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>u.target=a),type:"radio",value:"paid",class:"mr-2"},null,512),[[Z,u.target]]),N(" Siswa Sudah Bayar ("+o(W.value.length)+" siswa) ",1)])])]),e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Jeda Antar Pesan (detik) ",-1)),S(e("select",{"onUpdate:modelValue":t[10]||(t[10]=a=>u.delay=a),class:"input-field"},t[44]||(t[44]=[V('<option value="3">3 detik (cepat)</option><option value="5">5 detik</option><option value="10">10 detik (recommended)</option><option value="15">15 detik</option><option value="30">30 detik (aman)</option>',5)]),512),[[H,u.delay]])]),e("div",Yt,[e("button",{type:"button",onClick:L,class:"btn-secondary"}," Batal "),e("button",{type:"submit",disabled:g.value,class:"btn-primary"},o(g.value?"Menyimpan...":"Simpan Campaign"),9,Ft)])],32)])])])):A("",!0),E.value?(v(),x("div",{key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",onClick:t[14]||(t[14]=a=>E.value=!1)},[e("div",{class:"relative w-full max-w-2xl bg-white rounded-lg shadow-xl max-h-full overflow-y-auto",onClick:t[13]||(t[13]=G(()=>{},["stop"]))},[e("div",Xt,[e("div",es,[e("h3",ts," Detail Campaign: "+o((m=b.value)==null?void 0:m.title),1),e("button",{onClick:t[12]||(t[12]=a=>E.value=!1),class:"text-gray-400 hover:text-gray-600"},[M(w(te),{class:"w-6 h-6"})])]),b.value?(v(),x("div",ss,[e("div",as,[e("div",null,[t[46]||(t[46]=e("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),e("p",{class:O([Y(b.value.status),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},o(q(b.value.status)),3)]),e("div",null,[t[47]||(t[47]=e("label",{class:"text-sm font-medium text-gray-500"},"Total Penerima",-1)),e("p",ns,o(b.value.totalRecipients||0)+" nomor",1)])]),e("div",null,[t[48]||(t[48]=e("label",{class:"text-sm font-medium text-gray-500"},"Pesan",-1)),e("div",ls,[e("pre",os,o(b.value.message),1)])]),b.value.results?(v(),x("div",is,[t[52]||(t[52]=e("h4",{class:"font-medium text-gray-900 mb-3"},"ğŸ“Š Hasil Broadcast",-1)),e("div",rs,[e("div",null,[e("div",ds,o(b.value.results.sent||0),1),t[49]||(t[49]=e("div",{class:"text-sm text-gray-500"},"Berhasil",-1))]),e("div",null,[e("div",us,o(b.value.results.failed||0),1),t[50]||(t[50]=e("div",{class:"text-sm text-gray-500"},"Gagal",-1))]),e("div",null,[e("div",cs,o(b.value.results.total||0),1),t[51]||(t[51]=e("div",{class:"text-sm text-gray-500"},"Total",-1))])])])):A("",!0)])):A("",!0)])])])):A("",!0)])}}};export{xs as default};

import{r as p,Q as V,c as d,E as m,l as e,k as y,H as f,p as v,z as u,F as E,y as U,q as l,b as q,x as z,R as h,S as k}from"./vendor-Cn5j0SEu.js";import{b as F,u as H,h as G}from"./index-Dl3Gqoma.js";import{r as L}from"./PlusIcon-Hols0ICP.js";import{r as P,a as I}from"./TrashIcon-8_Rw6v_G.js";import"./excel-C9Ruqv6W.js";const K={class:"space-y-6"},O={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0"},Q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6"},R={class:"flex items-center space-x-4"},W={class:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center"},J={class:"text-primary-600 font-semibold text-lg"},X={class:"flex-1 min-w-0"},Y={class:"text-sm font-medium text-gray-900 truncate"},Z={class:"text-sm text-gray-500"},ee={class:"text-xs text-gray-400 mt-1"},te={class:"mt-4 flex items-center justify-between"},se={class:"flex items-center space-x-2"},ae={class:"flex items-center space-x-2"},ne=["onClick"],le=["onClick"],ie={key:0,class:"text-center py-12"},oe={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},re={class:"bg-white rounded-lg max-w-md w-full mx-4 p-4 sm:p-6"},de={class:"text-lg font-semibold text-gray-900 mb-4"},me={class:"flex justify-end space-x-3 pt-4"},ue=["disabled"],ce={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},pe={class:"bg-white rounded-lg max-w-md w-full mx-4 p-4 sm:p-6"},xe={class:"text-gray-600 mb-6"},be={class:"flex justify-end space-x-3"},ge=["disabled"],_e={__name:"Students",setup(fe){const i=F(),c=H(),x=p(!1),o=p(null),r=p(null),b=p(!1),g=p(!1),n=V({name:"",nickname:"",phone:""}),w=a=>i.transactions.filter(s=>s.type==="income"&&s.status==="completed").map(s=>s.student_id).includes(a)?"paid":"unpaid",M=a=>{o.value=a,n.name=a.name,n.nickname=a.nickname,n.phone=a.phone},T=a=>{r.value=a},_=()=>{x.value=!1,o.value=null,$()},$=()=>{n.name="",n.nickname="",n.phone=""},j=async()=>{try{b.value=!0;const a={name:n.name,nickname:n.nickname,phone:n.phone};o.value?(await i.db.updateStudent(o.value.id,a),c.success("Data siswa berhasil diupdate")):(await i.addStudent(a),c.success("Siswa baru berhasil ditambahkan")),_()}catch(a){c.error("Gagal menyimpan data siswa"),console.error("Error saving student:",a)}finally{b.value=!1}},D=async()=>{try{g.value=!0,await i.db.deleteStudent(r.value.id),await i.fetchStudents(),c.success("Siswa berhasil dihapus"),r.value=null}catch(a){c.error("Gagal menghapus siswa"),console.error("Error deleting student:",a)}finally{g.value=!1}};return(a,t)=>(m(),d("div",K,[e("div",O,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-xl sm:text-2xl font-semibold text-gray-900"},"Data Siswa"),e("p",{class:"text-sm text-gray-500 mt-1"},"Kelola data siswa kelas 1B SD Islam Al Husna")],-1)),e("button",{onClick:t[0]||(t[0]=s=>x.value=!0),class:"btn-primary w-full sm:w-auto"},[f(u(L),{class:"w-4 h-4 mr-2"}),t[6]||(t[6]=v(" Tambah Siswa ",-1))])]),e("div",Q,[(m(!0),d(E,null,U(u(i).students,s=>{var S,C,B,A;return m(),d("div",{key:s.id,class:"card p-4 sm:p-6 hover:shadow-md transition-shadow"},[e("div",R,[e("div",W,[e("span",J,l(((C=(S=s.nickname)==null?void 0:S.charAt(0))==null?void 0:C.toUpperCase())||((A=(B=s.name)==null?void 0:B.charAt(0))==null?void 0:A.toUpperCase())),1)]),e("div",X,[e("p",Y,l(s.name),1),e("p",Z,l(s.nickname),1),e("p",ee,l(s.phone),1)])]),e("div",te,[e("div",se,[e("span",{class:q(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",w(s.id)==="paid"?"bg-success-100 text-success-800":"bg-red-100 text-red-800"])},l(w(s.id)==="paid"?"Sudah Bayar":"Belum Bayar"),3)]),e("div",ae,[e("button",{onClick:N=>M(s),class:"p-1 text-gray-400 hover:text-primary-600"},[f(u(P),{class:"w-4 h-4"})],8,ne),e("button",{onClick:N=>T(s),class:"p-1 text-gray-400 hover:text-red-600"},[f(u(I),{class:"w-4 h-4"})],8,le)])])])}),128))]),u(i).students.length===0?(m(),d("div",ie,[f(u(G),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),t[8]||(t[8]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Belum ada data siswa",-1)),t[9]||(t[9]=e("p",{class:"text-gray-500 mb-4"},"Mulai dengan menambahkan data siswa pertama.",-1)),e("button",{onClick:t[1]||(t[1]=s=>x.value=!0),class:"btn-primary"}," Tambah Siswa ")])):y("",!0),x.value||o.value?(m(),d("div",oe,[e("div",re,[e("h3",de,l(o.value?"Edit Siswa":"Tambah Siswa Baru"),1),e("form",{onSubmit:z(j,["prevent"]),class:"space-y-4"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nama Lengkap",-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.name=s),type:"text",required:"",class:"input-field",placeholder:"Masukkan nama lengkap"},null,512),[[k,n.name]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nama Panggilan",-1)),h(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.nickname=s),type:"text",required:"",class:"input-field",placeholder:"Masukkan nama panggilan"},null,512),[[k,n.nickname]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nomor WhatsApp Orang Tua",-1)),h(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.phone=s),type:"text",required:"",class:"input-field",placeholder:"Contoh: +62 812-3456-7890"},null,512),[[k,n.phone]])]),e("div",me,[e("button",{type:"button",onClick:_,class:"btn-secondary"}," Batal "),e("button",{type:"submit",disabled:b.value,class:"btn-primary"},l(b.value?"Menyimpan...":"Simpan"),9,ue)])],32)])])):y("",!0),r.value?(m(),d("div",ce,[e("div",pe,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Hapus Siswa",-1)),e("p",xe,[t[13]||(t[13]=v(" Apakah Anda yakin ingin menghapus ",-1)),e("strong",null,l(r.value.name),1),t[14]||(t[14]=v("? Tindakan ini tidak dapat dibatalkan. ",-1))]),e("div",be,[e("button",{onClick:t[5]||(t[5]=s=>r.value=null),class:"btn-secondary"}," Batal "),e("button",{onClick:D,disabled:g.value,class:"btn-danger"},l(g.value?"Menghapus...":"Hapus"),9,ge)])])])):y("",!0)]))}};export{_e as default};
